## 简介

Shiro是一个开源的安全框架，提供认证、授权、企业级会话管理、加密。

Shiro提供的功能：

- 认证
- 访问控制
  - 判断用户是否具有某种角色
  - 判断用户是否可以执行该操作
- 在任何环境下都可以使用Session API
- React to events during authentication, access control, or during a session’s lifetime.
- Aggregate 1 or more data sources of user security data and present this all as a single composite user ‘view’.
- 单点登录（Single Sign On）功能
- 记得我（Remember Me）功能
- and much more - all integrated into a cohesive easy-to-use API.

## Shiro架构

从最高概念层面看，Shiro有三个重要的概念。

![](http://shiro.apache.org/assets/images/ShiroBasicArchitecture.png)

**Subject** 当前执行安全操作的用户

**SecurityManager** 

Shiro架构的核心，充当一种“伞形”对象，协调其内部安全组件，共同形成对象图。 但是，一旦为应用程序配置了SecurityManager及其内部对象图，通常就会将其保留，应用程序开发人员几乎将所有时间花在Subject API上。

**Realms** 

Realms act as the ‘bridge’ or ‘connector’ between Shiro and your application’s security data.

详细架构

![](http://shiro.apache.org/assets/images/ShiroArchitecture.png)

## 术语

- **Authentication**
  Authentication is the process of verifying a Subject’s identity - essentially proving that someone really is who they say they are. 

- **Authorization**
  Authorization, also known as Access Control, is the process of determining if a user/Subject is allowed to do something or not.

- **Cipher**

  A cipher is an algorithm for performing encryption or decryption. The algorithm generally relies on a piece of information called a key. And the encryption varies based on the key so decyrption is extremely difficult without it.

- **Credential**

  A Credential is a piece of information that verifies the identity of a user/Subject. One (or more) credentials are submitted along with Principal(s) during an authentication attempt to verify that the user/Subject submitting them is actually the associated user. Credentials are usually very secret things that only a particular user/Subject would know, such as a password or a PGP key or biometric attribute or similar mechanism.

  The idea is that for a principal, only one person would know the correct credential to ‘pair’ with that principal. If the current user/Subject provides the correct credential matching the one stored in the system, then the system can assume and trust that the current user/Subject is really who they say they are. The degree of trust increases with more secure credential types (e.g. biometric signature > password).

- **Cryptography**
  Cryptography is the practice of protecting information from undesired access by hiding it or converting it into nonsense so no one else can read it. Shiro focuses on two core elements of Cryptography: ciphers that encrypt data like email using a public or private key, and hashes (aka message digests) that irreversibly encrypt data like passwords.

- **Hash**
  A Hash function is a one-way, irreversible conversion of an input source, sometimes called the message, into an encoded hash value, sometimes called the message digest. It is often used for passwords, digital fingerprints, or data with an underlying byte array.

- **Permission**

  A Permission, at least as Shiro interprets it, is a statement that describes raw functionality in an application and nothing more. Permissions are the lowest-level constructs in security policies. They define only “What” the application can do. They do not describe “Who” is able to perform the actions. A Permission is only a statement of behavior, nothing more.

  Some examples of permissions:

  - Open a file
  - View the ‘/user/list’ web page
  - Print documents
  - Delete the ‘jsmith’ user

- **Principal**

  A Principal is any identifying attribute of an application user (Subject). An ‘identifying attribute’ can be anything that makes sense to your application - a username, a surname, a given name, a social security number, a user ID, etc. That’s it - nothing crazy.

  Shiro also references something we call a `Subject`’s *primary* principal. A *Primary* principal is any principal that uniquely identifies the `Subject` across the entire application. Ideal primary principals are things like a username or a user ID that is a RDBMS user table primary key. There is only one primary principal for users (Subjects) in an application.

- **Realm**

  A Realm is a component that can access application-specific security data such as users, roles, and permissions. It can be thought of as a security-specific DAO (Data Access Object). The Realm translates this application-specific data into a format that Shiro understands so Shiro can in turn provide a single easy-to-understand Subject programming API no matter how many data sources exist or how application-specific your data might be.

  Realms usually have a 1-to-1 correlation with a data source such as a relational database, LDAP directory, file system, or other similar resource. As such, implementations of the Realm interface use data source-specific APIs to discover authorization data (roles, permissions, etc), such as JDBC, File IO, Hibernate or JPA, or any other Data Access API.