---
title : 1.Java内存区域
categories : 
- JavaSE
- ch5类与对象的生命周期
date : 2018-10-30
---

# Java内存区域

Java虚拟机在执行Java程序的时候，会把它所管理的内存划分为若干个不同的数据区域。

![](https://github.com/huangdaren1997/pictures/blob/master/Java%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA.png?raw=true)

## 程序计数器

- 可以看作是当前线程所执行字节码的行号指示器
- 字节码解释器工作时就是通过改变这个计数器的值来获取下一条需要执行的字节码指令
- 线程私有，各个线程之间的程序计数器互不影响
- 如果执行的是Native方法，这个计数器的值为空

我们学过多线程，有两个线程，其中一个线程可以暂停使用，让其他线程运行，然后等自己获得cpu资源时，又能从暂停的地方开始运行，那么为什么能够记住暂停的位置的，这就依靠了程序计数器， 通过这个例子，大概了解一下程序计数器的功能。

## 虚拟机栈

虚拟机栈描述的是Java方法执行的内存模型。

什么是内存模型？ 有兴趣的可以看看着两篇文章

- [什么是内存模型？](https://www.cnblogs.com/adinosaur/p/6243605.html)
- [终于有人把Java内存模型说清楚了](http://developer.51cto.com/art/201807/579744.htm)

每个方法在执行的同时都会创建一个**栈帧**用来存放存储局部变量表、操作数表、动态连接、方法出口等信息，每一个方法从调用直至执行完成的过程，就对应着一个栈帧在虚拟机栈中入栈到出栈的过程。    这个话怎么理解呢？比如执行一个类(类中有main方法)时，执行到main方法，就会把为main方法创建一个栈帧，然后在加到虚拟机栈中，栈帧中会存放这main方法中的各种局部变量，对象引用等东西。我们常常听说的栈存储局部变量，说的就是这个。

## 本地方法栈

本地方法栈与虚拟机栈所发挥的作用是非常相似的，只不过一个是为Java方法服务，一个是为Native方法服务。

## Java堆

**栈：后进先出**

**堆：先进先出**

Java堆是所有线程共享的一块内存区域，在虚拟机启动时创建。

该区域的唯一目的就是存放对象实例，同时也是垃圾收集器管理的主要区域。

## 方法区

也是各个线程共享的内存区域，用于存储已经被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。

### 运行时常量池

运行时常量池是方法区的一部分。Class文件中除了有类的版本，字段，方法，接口等描述信息外，还有一项信息是常量池。常量池用于存放编译期生成的各种字面量和符号引用。

符号引用：用一组符号来描述所引用的目标，符号可以是任意形式的字面量，只要使用时能无歧义的定位到目标即可。

