---
title : AOP
categories : 
- JavaWeb
- Spring
date : 2018-11-29
---

# AOP

## 什么是AOP

### 横切关注点与AOP

**横切关注点（crosscutting concern）**

在了解横切关注点之前，我们首先要了解什么是关注点（`concern`）。

关注点（`concern`）：根据功能对系统进行划分，划分出来的结果就是关注点。例如我们常常会把一个系统分为表示层、业务层、持久层，这每一层就是一个关注点。

其中，关注点又分为两种类型：

- 核心关注点（`core concerns`）
- 横切关注点（`crosscutting concerns`）

核心关注点：表示主要需求的单一和特定功能的关注点称为核心关注点。例如在一个银行系统，你会关注用户管理、账户管理、贷款管理，还有对持久层和表示层的实现等等，这些都是核心关注点。

横切关注点：适用于整个应用程序，并影响整个应用程序的关注点称为横切关注点。例如安全认证、日志、缓存、性能监控、并发控制、事务管理等等。

**AOP**

​       随着项目的迭代，项目必然会变得越来越复杂，应对复杂，我们的解决方案就是模块化。通过把大问题分解成一个个小问题，然后再逐个击破。利用OOP很容易对核心关注点进行模块化。例如我们常常会看到类似的`LoanManagementService`类来实现业务逻辑，`AccountRepository`类来实现数据获取。对于横切关注点呢？传统上我们并没有对那些横切关注点进行模块化，就拿日志来说把，我们需要在每个类都写入一个日志字段，通过它实现日志记录功能，这就造成不同功能的代码纠缠（`Code tangling `）和代码分散（`Code scattering `）。然后很明显，OOP没办法帮我们处理这个问题，因为我们就是用了OOP所以才导致这个问题。

​	这时候就轮到AOP出场了，AOP是一种思想，它引入了新的模块化单元---切面(aspect)---来实现横切关注点的分离。例如日志记录的代码作为一个切面，事务管理的代码又作为一个切面，然后通过一些技术把这些切面（在编译时期或者在运行时）切入到核心关注点中，从而实现完整的功能。

下图是没有使用AOP时的情况

![1543651129560](https://github.com/huangdaren1997/pictures/blob/master/Spring/%E6%B2%A1%E6%9C%89%E4%BD%BF%E7%94%A8AOP%E6%97%B6.png?raw=true)

下图是使用AOP时的情况

![1543651196231](https://github.com/huangdaren1997/pictures/blob/master/Spring/%E4%BD%BF%E7%94%A8AOP%E6%97%B6.png?raw=true)

可以看出，在没有使用AOP时，安全模块处于被动调用的情况，我们很难对它的调用者进行统一管理。

而使用AOP时，安全模块通过切面可以主动选择它的调用者，从而实现对调用者的统一管理。

总之：AOP提供横切关注点的模块化。

### AOP基本术语

- aspect：切面是实现一个横切关注点的模块单元。

[AOP基本术语](http://www.ipcsit.com/vol1/26-A1596.pdf)



## AspectJ

AOP是一种思想，要想真正使用它，必须要有实现它的语言，AOP语言有不少，AspectJ就是其中之一，它最早出现也是目前为止最为强大的AOP语言。

## Spring AOP

### 例子

### @AspectJ

