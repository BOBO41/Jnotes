---
title : AOP基本概念
categories : 
- JavaWeb
- Spring
date : 2018-11-29
---

# AOP基本概念

## 横切关注点与AOP

​       随着项目的迭代，项目必然会变得越来越复杂，应对复杂，我们的解决方案就是模块化。通过把大问题分解成一个个小问题，然后再逐个击破。例如我们常常会把一个系统分为表示层、业务层、持久层。我们把这每一层都叫做系统关注点（`concerns of system`）。在银行系统，你会关注用户管理、账户管理、贷款管理，还有对持久层和表示层的实现。我们把这些叫做核心关注点（`core concerns`），因为他们组成系统的核心功能。对于其它关注点，例如安全认证、日志、缓存、性能监控、并发控制、事务管理等等，它们横切（crosscut）了其它模块。我们把这些叫做横切关注点（`crosscutting concerns`）。（我个人对横切的理解就是有些代码在很多地方都插了一脚0.0）

​	对于核心关注点，OOP是处理它们的好方法。例如我们常常会看到类似的`LoanManagementService`类来实现业务逻辑，`AccountRepository`类来实现数据获取。对于横切关注点呢？传统上我们并没有对那些横切关注点进行模块化，就拿日志来说把，我们需要在每个类都写入一个日志字段，通过它实现日志记录功能，这就造成不同功能的代码纠缠（`Code tangling `）和代码分散（`Code scattering `）。然后很明显，OOP没办法帮我们处理这个问题，因为我们就是用了OOP所以才导致这个问题。

​	这时候就轮到AOP出场了，AOP是一种思想，它引入了新的模块化单元---切面(aspect)---来实现横切关注点的分离。例如日志记录的代码作为一个切面，事务管理的代码又作为一个切面，然后通过一些技术把这些切面（在编译时期或者在运行时）切入到核心关注点中，从而实现完整的功能。

下图是没有使用AOP时的情况

![1543651129560](https://github.com/huangdaren1997/pictures/blob/master/Spring/%E6%B2%A1%E6%9C%89%E4%BD%BF%E7%94%A8AOP%E6%97%B6.png?raw=true)

下图是使用AOP时的情况

![1543651196231](https://github.com/huangdaren1997/pictures/blob/master/Spring/%E4%BD%BF%E7%94%A8AOP%E6%97%B6.png?raw=true)

可以看出，在没有使用AOP时，安全模块处于被动调用的情况，我们很难对它的调用者进行统一管理。

而使用AOP时，安全模块通过切面可以主动选择它的调用者，从而实现对调用者的统一管理。

写了这么多，我还是很难用一句话来概括AOP究竟是干嘛的。。。。。。我个人偏向理解为在不改变源代码的条件下，对代码的功能进行扩展或完善。

## AOP基本术语

- join points：在系统的运行过程中，系统会暴露出一些点，例如方法的执行、创建对象或者抛出一个异常，这些在系统中可识别的点，叫做`join points`，无论是否使用AOP，系统都会存在join points，AOP仅仅是对这些点进行识别和分类。
- pointcut：`join point`有很多，很明显我们不会全部都使用，我们要选出符合我们需求的`join point`，这些筛选出来的`join point`就叫做`pointcut`。
- advice：`join point`有了，那么我们就要对它们的功能进行替换或扩展，advice就是干这个的。
- aspect：AOP的最终目的就是产生一个携带横切逻辑的模块，这个模块就是`aspect`，它包含了`pointcuts`、`advice`

通俗来讲，`join points`：可以进行功能扩充的点，`pointcut`：需要进行功能扩充的点，`advice`：需要扩充的功能。

## 总结

AOP就是用来处理横切关注点的，了解什么是横切关注点，为什么OOP不好处理横切关注点，了解AOP是如何处理横切关注点，AOP出来之前是如何处理横切关注点的，如果能很好回答出这些问题，那么AOP应该是过关了，可惜写完这篇东西，我还是没能完全讲明白上面这些问题0.0

这些内容都是翻译自《AspectJ in action》第二版，个人觉得是本好书，很详细的介绍了AOP相关的知识，只可惜本人英文水平不好，只能略知一二。。。。。。

