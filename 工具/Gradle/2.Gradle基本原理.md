## 项目与任务

Gradle中有两个重要的概念，分别是项目(project)和任务(task)。

每个Gradle构建都由一个或多个*项目组成*。项目代表什么取决于您使用Gradle做什么。例如，项目可能表示库JAR或Web应用程序。项目不一定代表要构建的东西。它可能代表着要做的事情，例如将应用程序部署到生产环境。

每个项目由一个或多个*任务组成*。任务代表构建的一些工作。这可能是编译某些类，创建JAR，生成Java Doc或将一些存档发布到存储库。

您使用该`gradle`命令运行Gradle构建。该`gradle`命令查找`build.gradle`当前目录中调用的文件。我们称这个`build.gradle`文件为*构建脚本*。

### 创建项目

在Gradle中我们可以通过`gradle init`命名创建一个项目。具体在前一章大家已经体验过了。

### 任务的创建与执行



## 构建生命周期

Gradle构建有三个不同的阶段。

- 初始化

  Gradle支持单项目和多项目构建。在初始化阶段，Gradle确定哪些项目将参与构建，并为每个[项目](https://docs.gradle.org/current/dsl/org.gradle.api.Project.html)创建一个[Project](https://docs.gradle.org/current/dsl/org.gradle.api.Project.html)实例。

- 配置

  对Project实例进行配置。

- 执行

  根据需求执行部分已经创建并配置好的任务

## 依赖管理

![ä¾èµç®¡çå³è®®](/home/hdr/Desktop/Java-Notes/工具/images/gradle-dependency-management-resolution.png)

### 添加依赖

```groovy
dependencies {
    compile group:'log4j', name:'log4j', version:'1.2.17'
	compile (group:'log4j', name:'log4j', version:'1.2.17'){
    	// ... 额外配置
	}
    //导入本地jar包
    compile files('libs/xxx.jar')
    compile fileTree(dir: 'libs', include: ['*.jar'])
}
```

### 依赖范围

> (1) compile：源代码（src/main/java）编译时的依赖，最常用
>
> (2) runtime：源代码（src/main/java）执行时依赖
>
> (3) testCompile：测试代码（src/main/test）编译时的依赖
>
> (4) testRuntime：测试代码（src/main/java）执行时的依赖
>
> (5) archives：项目打包（e.g.jar）时的依赖

### 添加仓库

```groovy
repositories {
    mavenCentral() // Maven central repository
    jcenter()   
    google()
    maven {    // 自定义maven仓库
        url "http://repo.mycompany.com/maven2"
    }
    mavenLocal()
}
```



## 插件

插件的核心工作有两个：一是定义Task；而是执行Task。也就是说，我们想让Gradle能正常工作，完成整个构建流程中的一系列Task的执行，必须导入合适的插件，这些插件中定义了构建Project中的一系列Task，并且负责执行相应的Task。

```groovy
apply from: 'other.gradle' // gets the (plugin).gradle from a URL
apply plugin: 'java'       // gets the (plugin).gradle from the gradle plugin repository

plugins {
    id 'java'
    id 'com.jfrog.bintray' version '0.4.1'
}
```



## build.gradle常见用法

### buildscirpt{}

```groovy
// buildscript中的声明是gradle脚本自身需要使用的资源。
// 可以声明的资源包括依赖项、第三方插件、maven仓库地址等
buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
    }

    dependencies {
    // buildscript代码块中的repositories和dependencies的使用方式与直接在build.gradle文件中的使用方 式几乎完全一样。唯一不同之处是在buildscript代码块中你可以对dependencies使用classpath声明。该classpath声明说明了在执行其余的build脚本时，class loader可以使用这些你提供的依赖项。
        classpath 'org.apache.commons:commons-csv:1.0'
    }
}

// build.gradle文件中直接声明的依赖项、仓库地址等信息是项目自身需要的资源。
repositories {
     mavenCentral()
}

import org.apache.commons.csv.*

task printCSV() {
    doLast {
        def records = CSVFormat.EXCEL.parse(new FileReader('config/sample.csv'))
        for (item in records) {
            print item.get(0) + ' '
            println item.get(1)
        }

    }
}
```

### configure()



## 多项目构建

