## 构建脚本的基础知识

### [项目和任务](https://docs.gradle.org/current/userguide/tutorial_using_tasks.html#sec:projects_and_tasks)

Gradle中的所有内容都基于两个基本概念：*项目*和*任务*。

每个Gradle构建都由一个或多个*项目组成*。项目代表什么取决于您使用Gradle做什么。例如，项目可能表示库JAR或Web应用程序。项目不一定代表要构建的东西。它可能代表着要做的事情，例如将应用程序部署到生产环境。

每个项目由一个或多个*任务组成*。任务代表构建执行的一些原子工作。这可能是编译某些类，创建JAR，生成Javadoc或将一些存档发布到存储库。

您使用该`gradle`命令运行Gradle构建。该`gradle`命令查找`build.gradle`当前目录中调用的文件。我们称这个`build.gradle`文件为*构建脚本*，但严格来说它是一个构建配置脚本，我们稍后会看到。构建脚本定义项目及其任务。

#### 任务

```groovy
// build.gradle
// 构建一个任务
task hello {
    doLast {
        println 'Hello world!'
    }
}
```

```shell
# 执行任务
./gradlew hello
```

在构建脚本中我们可以使用Groovy和Kotlin的全部功能。

```groovy
task upper {
    doLast {
        String someString = 'mY_nAmE'
        println "Original: $someString"
        println "Upper case: ${someString.toUpperCase()}"
    }
}
```

**任务中调用其他任务**

```groovy
task hello {
    doLast {
        println 'Hello world!'
    }
}
task intro {
    dependsOn hello
    doLast {
        println "I'm Gradle"
    }
}
```

**动态创建任务**

```groovy
4.times { counter ->
    task "task$counter" {
        doLast {
            println "I'm task number $counter"
        }
    }
}

task0.dependsOn task2, task3
```

```shell
gradle -q task1
gradle -q task0
```

**向现有任务添加行为**

```groovy
task hello {
    doLast {
        println 'Hello Earth'
    }
}
hello.doFirst {
    println 'Hello Venus'
}
hello.configure {
    doLast {
        println 'Hello Mars'
    }
}
hello.configure {
    doLast {
        println 'Hello Jupiter'
    }
}
```

**构建脚本的外部依赖**

```groovy
import org.apache.commons.codec.binary.Base64

buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath group: 'commons-codec', name: 'commons-codec', version: '1.2'
    }
}

task encode {
    doLast {
        def byte[] encodedString = new Base64().encode('hello world\n'.getBytes())
        println new String(encodedString)
    }
}
```

